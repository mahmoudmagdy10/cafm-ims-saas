<div class="card card-custom" *ngIf="codes$ | async as codes">
  <!-- begin::Header -->
  <div class="card-header card-header-stretch align-items-center">
    <div class="card-title m-0">
      <!-- <i class="fa fa-warehouse fa-lg"></i> -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        version="1.1"
        id="Capa_1"
        x="0px"
        y="0px"
        width="418.879px"
        height="418.879px"
        viewBox="0 0 418.879 418.879"
        style="enable-background: new 0 0 418.879 418.879"
        xml:space="preserve"
        fill="#66a9ed"
        width="24px"
        height="24px"
      >
        <g>
          <g>
            <path
              d="M188.634,234.066c8.462-5.287,16.126-11.735,22.767-19.127l23.942,13.826l21.8-37.76l-23.894-13.796    c3.038-9.275,4.825-19.113,5.16-29.311l27.183-4.793l-7.574-42.938l-27.178,4.793c-3.756-9.309-8.795-17.965-14.906-25.744    l17.766-21.17L200.3,30.022l-17.751,21.152c-8.67-4.646-18.059-8.119-27.954-10.203V13.385h-43.6v27.586    c-9.896,2.084-19.285,5.557-27.956,10.203l-17.75-21.152l-33.4,28.025l17.764,21.17c-6.11,7.779-11.149,16.436-14.905,25.744    L7.57,100.168L0,143.106l27.179,4.793c0.335,10.199,2.123,20.035,5.161,29.313L8.444,191.007l21.801,37.759l23.943-13.822    c6.639,7.389,14.303,13.838,22.766,19.125l-9.451,25.963l40.972,14.91l9.438-25.928c4.864,0.688,9.831,1.053,14.882,1.053    c5.051,0,10.019-0.363,14.883-1.053l9.437,25.93l40.97-14.914L188.634,234.066z M132.793,200.065    c-30.702,0-55.68-24.977-55.68-55.68c0-30.701,24.978-55.68,55.68-55.68s55.68,24.979,55.68,55.68    C188.473,175.088,163.496,200.065,132.793,200.065z"
            />
            <path
              d="M376.041,266.807l-18.795,6.08c-3.584-6.229-8.014-11.869-13.115-16.779l10.504-16.764l-26.447-16.57l-10.498,16.75    c-6.604-2.438-13.602-3.973-20.826-4.471l-2.725-19.559l-30.912,4.309l2.725,19.559c-6.809,2.453-13.125,5.847-18.812,9.996    l-14.672-13.244l-20.912,23.168l14.684,13.259c-3.562,6.118-6.277,12.752-8.02,19.726l-19.744-0.714l-1.129,31.188l19.743,0.716    c1.246,7.198,3.486,13.991,6.558,20.271l-15.578,12.143l19.185,24.615l15.609-12.164c5.438,4.582,11.511,8.396,18.031,11.311    l-4.138,19.344l30.522,6.52l4.133-19.314c3.516,0.01,7.072-0.229,10.652-0.727c3.582-0.498,7.07-1.25,10.447-2.215l9.256,17.451    l27.574-14.623l-9.266-17.471c5.48-4.586,10.271-9.918,14.252-15.812l18.338,7.436l11.727-28.924l-18.303-7.422    c1.234-6.875,1.529-14.027,0.764-21.293l18.799-6.084L376.041,266.807z M297.129,350.006    c-21.771,3.031-41.949-12.209-44.98-33.977c-3.037-21.769,12.207-41.949,33.977-44.979c21.768-3.036,41.941,12.207,44.98,33.978    C334.135,326.795,318.896,346.969,297.129,350.006z"
            />
            <path
              d="M418.146,158.647l0.732-24.629l-15.586-0.463c-0.977-5.428-2.723-10.803-5.285-15.971l12.24-9.67l-15.271-19.33    l-12.238,9.666c-4.365-3.627-9.193-6.584-14.318-8.816l3.164-15.291l-24.123-4.996l-3.17,15.281    c-5.559,0.008-11.156,0.797-16.641,2.412l-7.391-13.727l-21.695,11.684l7.391,13.729c-4.363,3.686-8.107,7.934-11.176,12.566    l-14.496-5.77l-9.111,22.893l14.508,5.779c-0.955,5.508-1.141,11.158-0.514,16.799l-14.809,4.898l7.732,23.395l14.809-4.896    c2.9,4.986,6.426,9.396,10.426,13.201l-8.191,13.268l20.963,12.946l8.209-13.292c5.285,1.896,10.828,3.051,16.453,3.414    l2.252,15.453l24.383-3.561l-2.246-15.434c2.602-0.957,5.17-2.109,7.684-3.463c2.516-1.352,4.891-2.867,7.123-4.51l11.648,10.371    l16.387-18.398l-11.656-10.383c2.795-4.9,4.875-10.164,6.203-15.619L418.146,158.647z M359.436,171.844    c-15.281,8.227-34.404,2.492-42.627-12.783c-8.23-15.277-2.494-34.404,12.787-42.627c15.273-8.229,34.395-2.49,42.625,12.787    C380.443,144.499,374.711,163.616,359.436,171.844z"
            />
          </g>
        </g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
      </svg>
      <h4 class="fw-bolder mb-0 mx-2">
        {{ "STORES.CARD_HEADER" | translate }}
      </h4>
    </div>
    <div class="card-header-actions">
      <!-- فلتر -->
      <button
        class="general-btn filter-btn"
        style="margin-inline-end: 0.2rem"
        (click)="Filter()"
      >
        <span>
          <span><i class="fas fa-filter"></i></span>
          <span> {{ "STORES.MODALS.FILTER.MODAL_TITLE" | translate }} </span>
        </span>
      </button>

      <!-- اضافة قطعة غيار -->
      <button
        *ngIf="codes?.PagePermissions?.PartsAdd"
        class="general-btn add-btn"
        style="margin-inline-end: 0.2rem"
        (click)="AddSparePart()"
      >
        <span>
          <span><i class="fas fa-plus"></i></span>
          <span>
            {{ "STORES.MODALS.ADD_SPARE_PART.MODAL_TITLE" | translate }}
          </span>
        </span>
      </button>

      <!-- سندات الجرد و التسوية -->
      <button
        *ngIf="codes?.PagePermissions?.PartsAdjustmentVouchersShow"
        class="general-btn btn-info"
        style="margin-inline-end: 0.2rem"
        (click)="InventoryAndSettlementBonds()"
      >
        <span>
          <span><i class="fas fa-clipboard-list text-white"></i></span>
          <span>
            {{ "STORES.WAREHOUSE_INVENTORY_MODAL_BTN" | translate }}
          </span>
        </span>
      </button>

      <!-- ادارة المخازن -->
      <button
        *ngIf="
          codes?.PagePermissions?.PartsStoresManagementShow ||
          codes?.PagePermissions?.PartsStoresEdit
        "
        class="general-btn btn-info"
        style="margin-inline-end: 0.2rem"
        (click)="StoresManagement()"
      >
        <span>
          <span><i class="fa fa-warehouse text-white"></i></span>
          <span> {{ "STORES.WAREHOUSE_MODAL_BTN" | translate }} </span>
        </span>
      </button>

      <button
        *ngIf="codes?.PagePermissions?.PartsExport"
        class="btn btn-success mx-1"
        (click)="export()"
      >
        <span>
          <i class="fas fa-upload fa-lg"></i>

          {{ "ASSETS.ACTIONSONSELECTEDMENU.EXPORTDATA" | translate }}
        </span>
      </button>
      <!-- ادارة الحقول -->
      <button
        class="general-btn add-btn"
        (click)="fieldsManagment()"
        *ngIf="codes?.PagePermissions?.PartsCommonFieldsEdit"
      >
        <span>
          <span><i class="fas fa-columns"></i></span>
          <span>
            {{ "STORES.MODALS.FIELDS_MANAGEMENT.MODAL_TITLE" | translate }}
          </span>
        </span>
      </button>

      <!-- اجراءات على المحددين -->
      <!-- <button type="button" class="btn btn-success " data-kt-menu-trigger="click"
        data-kt-menu-placement="bottom-start">
        {{
        "GENERAL.PROCEDUERS_ON_SELECTED" | translate
        }}
      </button> -->
      <!--end::Trigger-->
      <!--begin::Menu-->

      <div
        class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
        data-kt-menu="true"
      >
        <!-- حذف المحددين -->
        <!--begin::Menu item-->
        <div class="menu-item px-3">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fa fa-print fa-lg"></i>
            <span class="mx-2">
              {{ "STORES.PROCEDUERS_ON_SELECTED.DELETE_SELECTED" | translate }}
            </span>
          </a>
        </div>
        <!--end::Menu item-->

        <!-- اضافة اصل -->
        <!--begin::Menu item-->
        <div class="menu-item px-3">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fas fa-file-import fa-lg"></i>
            <span class="mx-2">{{
              "STORES.PROCEDUERS_ON_SELECTED.ADD_ASSET" | translate
            }}</span>
          </a>
        </div>
        <!--end::Menu item-->

        <!-- اضافة مورد -->
        <!--begin::Menu item-->
        <div class="menu-item px-3">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fas fa-file-import fa-lg"></i>
            <span class="mx-2">{{
              "STORES.PROCEDUERS_ON_SELECTED.ADD_VENDOR" | translate
            }}</span>
          </a>
        </div>
        <!--end::Menu item-->

        <!-- امر شراء للقطع اقل من الحد الادني -->
        <!--begin::Menu item-->
        <div class="menu-item px-3">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fas fa-file-import fa-lg"></i>
            <span class="mx-2">{{
              "STORES.PROCEDUERS_ON_SELECTED.PARTSS_LESS_THAN_MIN" | translate
            }}</span>
          </a>
        </div>
        <!--end::Menu item-->

        <!-- نقل من مخزن لمخزن -->
        <!--begin::Menu item-->
        <div class="menu-item px-3">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fas fa-file-import fa-lg"></i>
            <span class="mx-2">{{
              "STORES.PROCEDUERS_ON_SELECTED.TRANSFER_BETWEEN_WAREHOUSES"
                | translate
            }}</span>
          </a>
        </div>
        <!--end::Menu item-->

        <!-- نقل لموقع عمل -->
        <!--begin::Menu item-->
        <div class="menu-item px-3">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fas fa-file-import fa-lg"></i>
            <span class="mx-2">{{
              "STORES.PROCEDUERS_ON_SELECTED.TRANSFER_TO_WORK_LOCATION"
                | translate
            }}</span>
          </a>
        </div>
        <!--end::Menu item-->

        <!--begin::Menu item-->
        <div class="menu-item px-3" (click)="export()">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fas fa-upload fa-lg"></i>
            <span class="mx-2">{{
              "PREVENTIVE_TASKS_MANAGEMENT.ACTIONS_ON_SELECTED.EXPORT"
                | translate
            }}</span>
          </a>
        </div>
        <!--end::Menu item-->

        <!--begin::Menu item-->
        <div class="menu-item px-3">
          <a href="javascript:;" class="menu-link px-3">
            <i class="fa fa-trash fa-lg"></i>
            <span class="mx-2">{{
              "PREVENTIVE_TASKS_MANAGEMENT.ACTIONS_ON_SELECTED.DELETE"
                | translate
            }}</span>
          </a>
        </div>
        <!--end::Menu item-->
      </div>
      <!--end::Menu-->
    </div>
  </div>
  <!-- end::Header -->
  <!-- begin::Body -->

  <div class="card-body">
    <div class="d-flex justify-content-start mb-3">
      <app-view-data-filter
        [componentType]="'sparParts'"
      ></app-view-data-filter>
    </div>
    <div class="d-flex justify-content-end mb-3">
      <app-field-show-in-table
        (sendFeildsViewInTable)="feildsViewInTable = $event"
        [DataFeild$]="fieldManagmentService.DataFeild$"
      >
      </app-field-show-in-table>
    </div>

    <div
      class="table-responsive"
      *ngIf="spareParts$ | async as data; else loading"
    >
      <table
        class="table table-rounded table-row-bordered border custom-table-style fs-6 text-start"
      >
        <thead>
          <tr class="fw-bolder fs-6 text-gray-800">
            <th>#</th>
            <th style="width: 17%">{{ "STORES.TABLE.NAME" | translate }}</th>
            <th>
              {{
                "ASSETS.ASSETCARDMODAL.BASICDATATAB.ADDFIELDMODAL.CATERORY"
                  | translate
              }}
            </th>
            <th>{{ "STORES.TABLE.NUMBER" | translate }}</th>
            <th>{{ "STORES.TABLE.QUANTITY" | translate }}</th>
            <!-- <th>التصنيف</th> -->
            <th>{{ "STORES.TABLE.PRICE" | translate }}</th>
            <th *ngFor="let obj of feildsViewInTable">
              {{ obj.Name }}
            </th>
            <th>{{ "GENERAL.PROCEDUERS" | translate }}</th>
          </tr>
        </thead>

        <tbody>
          <ng-container *ngIf="data?.Data?.length > 0; else noData">
            <tr *ngFor="let item of data?.Data; index as i">
              <td>
                <span class="reorder-row-icon">
                  {{ i + 1 + RowCount * (selectedPage - 1) }}
                </span>
              </td>

              <td>
                <i
                  [ngClass]="
                    item.InStockQuantity > 0
                      ? 'fa fa-cubes me-1 text-success'
                      : 'fa fa-cubes me-1 text-danger'
                  "
                ></i>

                <a
                  href="javascript:;"
                  (click)="
                    codes?.PagePermissions?.PartsEdit ||
                    codes?.PagePermissions?.PartsCard
                      ? SparePartCard(item.ID)
                      : ''
                  "
                >
                  {{ item.PartName }}
                </a>
              </td>
              <td>{{ item.CategoryName }}</td>

              <td>{{ item.PartNumber }}</td>
              <td>{{ item.InStockQuantity }}</td>
              <!-- <td>{{ item }}</td> -->
              <td>{{ item.AveragePrice }}</td>
              <td *ngFor="let obj of feildsViewInTable">
                {{ ValueField(obj.ID, item.Fields) }}
              </td>
              <td>
                <i
                  *ngIf="codes?.PagePermissions?.PartsDelete"
                  class="fas fa-trash-alt action-icon delete-icon"
                  tooltipPosition="top"
                  pTooltip="{{ 'GENERAL.DELETE' | translate }}"
                  (click)="idDeleted = item.ID; confirmdeletePart.openModal()"
                ></i>
              </td></tr
          ></ng-container>
        </tbody>
      </table>
      <app-pagination-component
        [Setting]="data?.Setting"
        [(selectedPage)]="selectedPage"
        (selectedPageChange)="changePage()"
        (selectedRowCount)="selectedRowCount($event)"
      ></app-pagination-component>
    </div>
  </div>

  <!-- end::Body -->

  <!-- begin::Footer -->

  <!-- end::Footer -->
</div>
<ng-template #loading>loading...</ng-template>
<confirm-delete
  #confirmdeletePart
  massage="   {{ 'STORES.CARD_HEADER' | translate }} "
  (afterSave)="$event ? deleteSparePart() : ''; confirmdeletePart.CloseModal()"
>
</confirm-delete>
<ng-template #noData>
  <app-no-data></app-no-data>
</ng-template>
