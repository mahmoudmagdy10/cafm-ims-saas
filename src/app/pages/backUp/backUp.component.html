<div class="card card-custom">
  <!-- begin::Header -->
  <div class="card-header card-header-stretch align-items-center">
    <div class="card-title m-0">
      <!-- https://www.svgrepo.com/svg/420196/lock-protect-security-15 -->
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32">
        <path
          fill-rule="evenodd"
          d="M25 4.19a6.996 6.996 0 0 0-5.76 3.03c-2.814.246-5.22 2.106-6.263 4.766-.283-.042-.564-.094-.85-.095a.5.5 0 0 0-.002 0c-2.876 0-5.238 2.121-5.752 4.923-.403-.102-.804-.219-1.22-.22a.5.5 0 0 0-.003 0C2.31 16.594 0 18.933 0 21.797c0 2.864 2.309 5.2 5.15 5.201.112 0 .194-.012.264-.018-.085 0-.046.018.123.018h20.926c.45 0 .864-.101 1.242-.238 2.54-.735 4.293-3.08 4.295-5.746a6.003 6.003 0 0 0-2.258-4.69A6.976 6.976 0 0 0 32 11.19c0-3.86-3.14-7-7-7zm0 1c3.32 0 6 2.68 6 6a5.983 5.983 0 0 1-2.35 4.76A5.971 5.971 0 0 1 25 17.19c-3.32 0-6-2.68-6-6s2.68-6 6-6zm-.082 1.779c-.124.03-.225.13-.324.23l-2.719 2.719c-.723.389.201 1.36.625.656l2.031-2.031v6.375c-.046.67.984.67.938 0V8.543l2.031 2.031c.424.704 1.348-.267.625-.656L25.437 7.23a.467.467 0 0 0-.062-.062c-.188-.188-.334-.229-.457-.2zm-6.299 1.355A6.952 6.952 0 0 0 18 11.19c0 3.86 3.14 7 7 7 1.459 0 2.815-.45 3.938-1.216A4.995 4.995 0 0 1 31 21.016c-.003 2.234-1.468 4.187-3.588 4.793a.5.5 0 0 0-.035.011c-.306.113-.606.18-.914.18H5.537c.086 0 .046-.016-.123-.016a.5.5 0 0 0-.035 0 2.48 2.48 0 0 1-.229.014c-2.294 0-4.15-1.871-4.15-4.201 0-2.33 1.854-4.202 4.148-4.203.48 0 .953.088 1.403.254a.5.5 0 0 0 .672-.424c.232-2.573 2.354-4.532 4.9-4.533.347 0 .694.04 1.033.115a.5.5 0 0 0 .582-.332 6.494 6.494 0 0 1 4.881-4.35z"
          color="#000"
          font-family="sans-serif"
          font-weight="400"
          overflow="visible"
          style="
            line-height: normal;
            text-indent: 0;
            text-align: start;
            text-decoration-line: none;
            text-decoration-style: solid;
            text-decoration-color: #000;
            text-transform: none;
            block-progression: tb;
            white-space: normal;
            isolation: auto;
            mix-blend-mode: normal;
            solid-color: #000;
            solid-opacity: 1;
          "
        />
      </svg>
      <h4 class="fw-bolder mb-0 mx-2">
        {{ "Backup" | translate }}
      </h4>
    </div>
    <div class="card-header-actions"></div>
  </div>
  <!-- end::Header -->
  <!-- begin::Body -->

  <div class="card-body">
    <!-- <div class="row">
      <div class="col-6">
        <div class="form-group">
          <label class="form-label">
            {{ "Choose Template" | translate }}
          </label>
          <p-dropdown
            appendTo="body"
            class="custom-dropdown"
            [options]="AllTemplateWithoutSelected"
            [style]="{ minWidth: '130px', display: 'flex' }"
            optionLabel="Template"
            optionValue="Id"
            [placeholder]="'GENERAL.SELECT' | translate"
            [filter]="true"
            filterBy="name"
            [emptyMessage]="'All Template Selected'"
            (onChange)="selectTemplate($event.value)"
          >
          </p-dropdown>
        </div>
      </div>
    </div>
    <div class="row mt-5">
      <div class="col-3" *ngFor="let item of TemplateSelected">
        <div class="row align-items-center mb-3">
          <div class="col-10">
            <div class="form-group">
              <label class="form-control form-control-solid">
                {{ item.TemplateTitle }}</label
              >
            </div>
          </div>
          <div class="col-2" style="text-align: end">
            <i
              (click)="
                itemTemplateSelectedDeleted = item;
                confirmdeleteTemplateSelected.openModal()
              "
              class="fas fa-trash-alt action-icon delete-icon"
              tooltipPosition="top"
            ></i>
          </div>
        </div>
      </div>

    </div> -->

    <div class="mt-5">
      <form [formGroup]="BackupConfigForm">
        <p-fieldset legend="Setting Backup">
          <div class="row">
            <div class="col-6">
              <div class="form-group">
                <label class="form-label">
                  {{ "Choose Locations" | translate }}
                </label>
                <p-dropdown
                  appendTo="body"
                  class="custom-dropdown"
                  [options]="Locations"
                  [style]="{ minWidth: '130px', display: 'flex' }"
                  optionLabel="LocationName"
                  optionValue="LocationId"
                  [placeholder]="'GENERAL.SELECT' | translate"
                  [filter]="true"
                  filterBy="name"
                  formControlName="LocationId"
                  [emptyMessage]="'All Locations Selected'"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-2">
              <div class="form-group">
                <label class="mb-2"> Backup Every </label>
                <p-dropdown
                  appendTo="body"
                  class="custom-dropdown"
                  optionLabel="name"
                  optionValue="id"
                  [options]="BackupEveryItems"
                  [style]="{ minWidth: '130px', display: 'flex' }"
                  [placeholder]="'GENERAL.SELECT' | translate"
                  formControlName="BackupEvery"
                >
                </p-dropdown>
              </div>
            </div>
            <div class="col-4">
              <label class="mb-2 required"> Backup Begin Date </label>
              <p-calendar
                placeholder="dd-mm-yy"
                inputId="time"
                appendTo="body"
                dateFormat="dd/mm/yy"
                [showIcon]="true"
                formControlName="BackupBeginDate"
              ></p-calendar>
            </div>
            <div class="col-4">
              <label class="mb-2 required"> Backup Begin Time </label>
              <p-calendar
                placeholder="HH:mm"
                inputId="time"
                appendTo="body"
                [showIcon]="true"
                [timeOnly]="true"
                formControlName="BackupBeginTime"
              ></p-calendar>
            </div>
            <div class="col-2">
              <button
                style="margin-top: 27px"
                type="button"
                class="general-btn add-btn"
                label="Show"
                (click)="addBackupConfig()"
              >
                <i class="pi pi-save"></i>
                Save
              </button>
            </div>
          </div>
        </p-fieldset>
      </form>
    </div>
    <div class="mt-5">
      <p-fieldset legend="Backups List">
        <div class="table-responsive">
          <table
            class="table table-rounded table-row-bordered border custom-table-style vertical-align-middle"
          >
            <thead class="fw-bolder">
              <tr>
                <th scope="col">#</th>
                <th scope="col">Location Name</th>
                <th scope="col">Backup Every</th>
                <th scope="col">Backup Begin Date</th>
                <th scope="col">Backup Begin Time</th>

                <th scope="col">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of BackupsConfig; index as i">
                <td>{{ i + 1 }}</td>
                <td>{{ item.LocationName }}</td>
                <td>
                  {{
                    item.BackupEvery == 1
                      ? "Daily"
                      : item.BackupEvery == 2
                      ? "Monthly"
                      : item.BackupEvery == 3
                      ? "Yearly"
                      : ""
                  }}
                </td>
                <td>{{ item.BackupBeginDate }}</td>
                <td>{{ item.BackupBeginTime | date : "HH:mm" }}</td>
                <td>
                  <div class="actions d-flex flex-nowrap">
                    <i
                      *ngIf="!item.loading"
                      (click)="downloadBackupForLocation(item)"
                      class="fas fa-file-download action-icon"
                      tooltipPosition="top"
                    ></i>
                    <i class="action-icon" *ngIf="item.loading">
                      <div
                        class="spinner-border text-dark"
                        style="width: 10px; height: 10px"
                        role="status"
                      >
                        <span class="sr-only">Loading...</span>
                      </div>
                    </i>
                    <i
                      (click)="
                        itemBackupConfigDeleted = item;
                        confirmdeleteBackupConfig.openModal()
                      "
                      class="fas fa-trash-alt action-icon delete-icon"
                      tooltipPosition="top"
                    ></i>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </p-fieldset>
    </div>
    <!-- end::Body -->

    <!-- begin::Footer -->

    <!-- end::Footer -->
  </div>
</div>
<confirm-delete
  #confirmdeleteBackupConfig
  (afterSave)="
    $event ? deleteBackupConfig() : ''; confirmdeleteBackupConfig.CloseModal()
  "
>
</confirm-delete>
<confirm-delete
  #confirmdeleteTemplateSelected
  (afterSave)="
    $event ? deleteTemplateSelected() : '';
    confirmdeleteTemplateSelected.CloseModal()
  "
>
</confirm-delete>
